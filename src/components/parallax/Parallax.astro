---
import Background from '@assets/parallax/background.webp';
import Dust from '@assets/parallax/dust.webp';
import Logo from '@components/ui/Logo.astro';
import { Image } from 'astro:assets';
---

<div class="parallax">
	<div class="parallax__hero">
		<slot name="hero-section" />
	</div>
	<div class="parallax__bg">
		<Image src={Background} alt="Background Image" />
	</div>
	<div class="parallax__fg"></div>
	<div class="parallax__dust">
		<Image src={Dust} alt="Dust Image" />
	</div>
	<div class="parallax__logo">
		<Logo type={2} />
	</div>
	<div class="parallax__foreground-back"></div>
	<div class="parallax__foreground-front"></div>
</div>

<style lang="scss">
	.parallax {
		--parallax-speed-hero: 20;
		--parallax-speed-bg: 7;
		--parallax-speed-fg: -2;
		--parallax-speed-dust: -5;
		--parallax-speed-logo: 5;

		position: relative;
		z-index: 0;
		height: 60vh;
		display: grid;
		grid-template-rows: 100%;
		grid-template-areas: 'stack';
		contain: paint;
	}

	.parallax > * {
		grid-area: stack;
		animation: parallax linear;
		animation-timeline: scroll();
	}

	.parallax img {
		width: 100%;
		object-fit: cover;
	}

	.parallax__hero {
		--parallax-speed: var(--parallax-speed-hero);
		z-index: 4;
	}

	.parallax__bg {
		--parallax-speed: var(--parallax-speed-bg);
		z-index: 1;
	}

	.parallax__fg {
		--parallax-speed: var(--parallax-speed-fg);
		height: 70vh;
		z-index: 3;
		position: relative;
		background-image: url('@assets/parallax/foreground.webp');
		background-size: cover;
		background-position: top center;
		bottom: -7rem;
		transition: bottom 500ms ease;
		@include mq('md') {
			bottom: -3rem;
		}
		@include mq('xl') {
			bottom: 2rem;
		}
	}

	.parallax__dust {
		height: 100vh;
		--parallax-speed: var(--parallax-speed-dust);
		z-index: 2;
		img {
			object-fit: cover;
		}
	}

	.parallax__logo {
		--parallax-speed: var(--parallax-speed-logo);
		z-index: 4;
		position: absolute;
		right: 13vw;
		top: 10rem;
		width: 10vw;
		height: 10vw;
		min-width: 75px;
		min-height: 75px;
		max-width: 250px;
		max-height: 250px;
		filter: drop-shadow(0px 0px 20px rgba(0, 0, 0, 0.8));
	}

	.parallax__foreground-front,
	.parallax__foreground-back {
		clip-path: polygon(
			100% 100%,
			0% 100%,
			0 100%,
			6% 86%,
			21% 83%,
			37% 73%,
			54% 73%,
			70% 50%,
			88% 47%,
			100% 14%
		);
		width: calc(100% + 2rem);
		height: 200px;
		align-self: end;
		margin-left: -2rem;
		margin-bottom: -0.5rem;
		z-index: 10;
	}

	.parallax__foreground-back {
		background-color: $tertiary-color;
		transform: scaleY(1.2);
		transform-origin: bottom;
		opacity: 0.7;
	}

	@keyframes parallax {
		to {
			transform: translateY(calc(var(--parallax-speed) * 100px));
		}
	}
</style>
