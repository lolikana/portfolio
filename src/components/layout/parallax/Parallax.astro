---
import Background from '@assets/parallax/background.png';
import Dust from '@assets/parallax/dust.webp';
// import Foreground from '@assets/parallax/foreground.png';
import ForegroundBack from '@assets/parallax/foreground-back.webp';
import ForegroundFront from '@assets/parallax/foreground-front.webp';
import Logo from '@components/ui/Logo.astro';
import { Image } from 'astro:assets';
---

<div class="parallax">
	<slot />
	<div class="parallax__bg">
		<Image src={Background} alt="" width={Background.width} />
	</div>
	<div class="parallax__fg"></div>
	<div class="parallax__dust">
		<Image src={Dust} alt="" width={Dust.width} />
	</div>
	<div class="parallax__logo">
		<Logo type={2} />
	</div>
	<div class="parallax__foreground-back">
		<Image src={ForegroundBack} alt="" width={ForegroundBack.width} />
	</div>
	<div class="parallax__foreground-front">
		<Image src={ForegroundFront} alt="" width={ForegroundFront.width} />
	</div>
</div>

<style lang="scss">
	.parallax {
		position: relative;
		z-index: 0;
		min-height: 50vh;
		max-height: 750px;
		display: grid;
		grid-template-rows: 100%;
		grid-template-areas: 'stack';
	}

	.parallax > * {
		grid-area: stack;
		animation: parallax linear;
		animation-timeline: scroll();
	}

	.parallax img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.parallax__bg {
		--parallax-speed: 7;
		z-index: 1;
	}

	.parallax__fg {
		--parallax-speed: -10;
		height: 120%;
		z-index: 2;
		position: relative;
		bottom: -6rem;
		background-image: url('@assets/parallax/foreground.png');
		background-size: cover;
		background-position: top center;
		filter: brightness(90%) drop-shadow(0px 0px 100px rgba(255, 255, 255, 0.7));
	}

	.parallax__dust {
		--parallax-speed: -15;
		z-index: 3;
		img {
			object-fit: cover;
		}
	}

	.parallax__logo {
		--parallax-speed: 5;
		z-index: 11;
		position: absolute;
		right: 13vw;
		top: 10rem;
		width: 10vw;
		height: 10vw;
		min-width: 75px;
		min-height: 75px;
		max-width: 250px;
		max-height: 250px;

		filter: drop-shadow(0px 0px 20px rgba(0, 0, 0, 0.8));
	}

	.parallax__foreground-front,
	.parallax__foreground-back {
		width: calc(100% + 1rem);
		position: absolute;
		bottom: -0.6rem;
		margin-left: -1rem;
		z-index: 10;
	}

	.parallax__foreground-back {
		filter: $filter-tertiary;
		transform: scaleY(1.2);
		transform-origin: bottom;
		opacity: 0.7;
	}

	@keyframes parallax {
		to {
			transform: translateY(calc(var(--parallax-speed) * 100px));
		}
	}
</style>
